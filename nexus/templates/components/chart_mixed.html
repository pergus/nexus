{# Reusable mixed chart component #}
{# Usage: {% include 'components/chart_mixed.html' with chart_id="my-mixed-chart" series_data=series_data chart_title="My Mixed Chart" height=380 %} #}

<div class="card">
  <div class="card-header">
    <h4 class="card-title mb-0">{{ chart_title|default:"Mixed Chart" }}</h4>
  </div>
  <div class="card-body">
    <div dir="ltr">
      <div id="{{ chart_id|default:'apex-mixed-chart' }}" class="apex-charts" style="min-height: {{ height|default:380 }}px;"></div>
    </div>
  </div>
</div>

{# Script to initialize the chart - should be placed in the template where this component is used #}
{# Example initialization script:
<script>
  var options = {
    chart: {
      height: {{ height|default:380 }},
      type: 'line',
      stacked: {{ stacked|yesno:"true,false"|default:"false" }},
      toolbar: { show: false }
    },
    stroke: {
      width: [0, 2, {{ stroke_width|default:2 }}],
      curve: '{{ curve|default:"smooth" }}'
    },
    plotOptions: {
      bar: {
        columnWidth: '{{ column_width|default:"50%" }}'
      }
    },
    series: {{ series_data|safe }},
    xaxis: {
      categories: {{ xaxis_categories|default:"[]"|safe }},
      title: {
        text: '{{ xaxis_title|default:"" }}'
      }
    },
    yaxis: [
      {
        title: {
          text: '{{ yaxis1_title|default:"" }}',
        },
      },
      {
        opposite: true,
        title: {
          text: '{{ yaxis2_title|default:"" }}',
        },
      },
    ],
    fill: {
      opacity: {{ fill_opacity|default:1 }}
    },
    tooltip: {
      y: {
        formatter: function (val) {
          return val + " {{ tooltip_unit|default:"" }}";
        }
      }
    },
    colors: {{ colors|default:"['#6658dd', '#4fc6e1', '#4a81d4', '#00b19d', '#f1556c']"|safe }},
    grid: {
      borderColor: '#f1f3fa',
      padding: {
        bottom: 5
      }
    },
    legend: {
      position: "{{ legend_position|default:'top' }}",
      horizontalAlign: "{{ legend_align|default:'right' }}",
      offsetY: {{ legend_offset_y|default:-25 }},
      offsetX: {{ legend_offset_x|default:-5 }}
    },
    responsive: [{
      breakpoint: 600,
      options: {
        chart: {
          toolbar: { show: false }
        },
        legend: { show: false }
      }
    }]
  };

  var chart = new ApexCharts(document.querySelector("#{{ chart_id|default:'apex-mixed-chart' }}"), options);
  chart.render();
</script>
#}